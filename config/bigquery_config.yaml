# BigQuery Configuration
version: "1.0"

# Connection settings are now managed via .streamlit/secrets.toml
connection:
  location: "europe-north1"  # BigQuery dataset location (must match dataset region)

# BigQuery table schema
table_schema:
  - name: date
    type: TIMESTAMP
    mode: REQUIRED
    description: "Date and time of the workout/exercise"
    
  - name: workout_name
    type: STRING
    mode: REQUIRED
    description: "Name or type of workout session"
    
  - name: exercise_name
    type: STRING
    mode: REQUIRED
    description: "Name of the exercise performed"
    
  - name: weight_kg
    type: FLOAT
    mode: REQUIRED
    description: "Weight used in kilograms"
    
  - name: weight_lb
    type: FLOAT
    mode: NULLABLE
    description: "Weight used in pounds"
    
  - name: reps
    type: INTEGER
    mode: REQUIRED
    description: "Number of repetitions"
    
  - name: notes
    type: STRING
    mode: NULLABLE
    description: "Additional notes about the exercise"
    
  - name: duration
    type: INTEGER
    mode: NULLABLE
    description: "Duration of exercise in minutes"
    
  - name: upload_timestamp
    type: TIMESTAMP
    mode: REQUIRED
    description: "Timestamp when data was uploaded to BigQuery"
    
  - name: data_source
    type: STRING
    mode: NULLABLE
    description: "Source of the data (e.g., csv_upload)"

# Upload settings
upload:
  write_disposition: "WRITE_APPEND"  # WRITE_TRUNCATE, WRITE_APPEND, WRITE_EMPTY
  create_disposition: "CREATE_IF_NEEDED"  # CREATE_IF_NEEDED, CREATE_NEVER
  batch_size: 1000
  timeout_seconds: 300
  skip_leading_rows: 0
  allow_jagged_rows: false
  allow_quoted_newlines: true

# BigQuery views configuration
views:
  enabled: true
  dataset_id: "${BQ_DATASET_ID}"
  view_definitions:
    - name: "workout_frequency_by_muscle_group"
      sql_file: "sql/views/workout_frequency_by_muscle_group.sql"
    - name: "workout_frequency_by_exercise"
      sql_file: "sql/views/workout_frequency_by_exercise.sql"
    - name: "exercise_performance_metrics"
      sql_file: "sql/views/exercise_performance_metrics.sql"
  refresh_on_upload: true
